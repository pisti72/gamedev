var Map = {
    level: 1,
    blocks: [],
    actors: [],
    gems: 0,
    item: {
        wall: '&#128997;',
        //wall: '&#9607;',
        gem: '&#128312;',
        //gem: '.',
        player: '&#128526',
        //player: '&#9786',
        enemy: '&#128027',
        //enemy: '&#9787',
        space:'&#12288;',
        //space:'&nbsp;',
        //space: '&#128313;'
    },
    copyLevelToBlock: function () {
        this.blocks = [];
        this.gems = 0;
        this.actors = [];
        var level = this.levels[this.level - 1];
        for (var i = 0; i < level.length; i++) {
            var row = level[i];
            var newrow = '';
            for (var j = 0; j < row.length; j++) {
                var char = row.charAt(j);
                if (char == '2') {
                    this.addActor('player', j, i);
                    char = '.';
                    this.gems++;
                } else if (char == '3') {
                    this.addActor('enemy', j, i);
                    char = '.';
                    this.gems++;
                }
                newrow += char;
            }
            this.blocks.push(newrow);
        }
    },
    addActor: function (name, x, y) {
        var actor = {
            name: name,
            x: x,
            y: y,
            score: 0,
            life: 3,
            xd: 0,
            yd: 0,
            speed: 0,
        }
        this.actors.push(actor);
    },
    isActorHere: function (x, y) {
        for (var i = 0; i < this.actors.length; i++) {
            var actor = this.actors[i];
            if (actor.x == x && actor.y == y) {
                return true;
            }
        }
        return false;
    },
    getActorFromHere: function (x, y) {
        for (var i = 0; i < this.actors.length; i++) {
            var actor = this.actors[i];
            if (actor.x == x && actor.y == y) {
                return actor;
            }
        }
        return false;
    },
    getActorByName: function (name) {
        for (var i = 0; i < this.actors.length; i++) {
            var actor = this.actors[i];
            if (actor.name == name) {
                return actor;
            }
        }
        return false;
    },
    render: function () {
        var s = '';
        for (var i = 0; i < this.blocks.length; i++) {
            var row = this.blocks[i];
            var newrow = '';
            for (var j = 0; j < row.length; j++) {
                if (this.isActorHere(j, i)) {
                    actor = this.getActorFromHere(j, i);
                    if (actor.name == 'player') {
                        newrow += this.item.player;
                    } else if (actor.name == 'enemy') {
                        newrow += this.item.enemy;
                    }
                } else {
                    var char = row.charAt(j);
                    if (char == '1') {
                        newrow += this.item.wall;
                    } else if (char == '.') {
                        newrow += this.item.gem;
                    } else if (char == ' ') {
                        newrow += this.item.space;
                    } else {
                        newrow += char;
                    }
                }
            }
            s += newrow + '</br>';
        }
        return s;
    },
    getBlock: function (x, y) {
        var row = this.blocks[y];
        return row.charAt(x);
    },
    setBlock: function (n, x, y) {
        var row = this.blocks[y];
        newrow = row.substr(0, x) + n + row.substr(x + 1, row.length - x - 1);
        this.blocks[y] = newrow;
    },
    setActor: function (n, x, y) {

    },
    levels: [
        [									//ebben a t�mbben t�roljuk az �sszes p�ly�t
            "1111111111111111111111111111111",
            "1.............1111111........31",
            "1.11111111111.1111111.1111111.1",
            "1.11111111111.1111111.1111111.1",
            "1.11111111111.........1111111.1",
            "1.11111..1111.1111111.........1",
            "1.11111..1111.11111111111.11111",
            "1.............11111111111.11111",
            "1111111.11111111111111111.11111",
            "1111111.11111111111111111.11111",
            "1111111.1111111111111.........1",
            "1111111.1111111111111.111.111.1",
            "111111....21111111111.1111111.1",
            "1111111.1111111111111.1111111.1",
            "1111111.1111111111111.1111111.1",
            "1..........1111111111.1111111.1",
            "1.11111111.1111111111.1111111.1",
            "1.11111111.1111111111.1111111.1",
            "1.11111111.1111111111.1111111.1",
            "1..111111..1111111111.1111111.1",
            "1.11111111............1111111.1",
            "1.11111111.1111111111.1111111.1",
            "1.11111111.1111111111.111.111.1",
            "13.........1111111111.........1",
            "1111111111111111111111111111111"
        ], [
            "1111111111111111111111111111111",
            "1............................31",
            "1.1111111111111.1111111111111.1",
            "1.1.........................1.1",
            "1.1.11111111111.11111111111.1.1",
            "1.1.13....................1.1.1",
            "1.1.1.111111111.111111111.1.1.1",
            "1.1.1.1.................1.1.1.1",
            "1.1.1.1.1111111.1111111.1.1.1.1",
            "1.1.1.1.1.............1.1.1.1.1",
            "1.1.1.1.1.11111.11111.1.1.1.1.1",
            "1.1.1.1.1.1.........1.1.1.1.1.1",
            "..........1.........1..........",
            "1.1.1.1.1.1.........1.1.1.1.1.1",
            "1.1.1.1.1.11111.11111.1.1.1.1.1",
            "1.1.1.1.1.............1.1.1.1.1",
            "1.1.1.1.1111111.1111111.131.1.1",
            "1.1.1.1.................1.1.1.1",
            "1.1.1.111111111.111111111.1.1.1",
            "1.1.1.....................1.1.1",
            "1.1.11111111111.11111111111.1.1",
            "1.1.........................1.1",
            "1.111111111111121111111111111.1",
            "13............................1",
            "1111111111111111111111111111111"
        ], [
            "1111111111111111111111111111111",
            "13...........................31",
            "1.1111111.............111.111.1",
            "1.1.....1.............1.....1.1",
            "1.....................1.....1.1",
            "1.1.....1.............1.....1.1",
            "1.111 111.............111.111.1",
            "1.............................1",
            "1......                 ......1",
            "1.....     1111 1111     .....1",
            "1....      1.......1      ....1",
            "1...       1 1.2.1.1       ...1",
            "1..        ..11111..        ..1",
            "1..        1.1...1.1        ..1",
            "1..        1.......1        ..1",
            "1...       111111111       ...1",
            "1....        .  .         ....1",
            "1.....      ......       .....1",
            "1.1111111.    1.1    .1111111.1",
            "1.1.......    1.1    .1.....1.1",
            "1.1.......    1.1    .......1.1",
            "1.1.....1.    1.1    .......1.1",
            "1.1111111.    1.1    .1111111.1",
            "13...........................31",
            "1111111111111111111111111111111"
        ], [
            "1111111111111111111111111111111",
            "1..2..............1...........1",
            "1.11111111111.111.1.1.1.11111.1",
            "1.1.........1...1...1.1.1...1.1",
            "1.1.11111.1.111.1.1.1.1.1.3.1.1",
            "1.1.1...1.1.1...1.1.1.1.1...1.1",
            "1.1.1.1.1.111.111111111.11.11.1",
            "1...1.1.1...........1.1.......1",
            "1.1.1.1.11111.11111.1.1.11111.1",
            "1.1.1.......1...1.1.1.1.1.....1",
            "1.1.1111111.1.1.1.1.1.1...111.1",
            "1.1...1.1.1.1.1.1.1.1.11111.1.1",
            "1.111.1.1.1.1.131.1........31.1",
            "1...1.1.1.....1.1.11111111111.1",
            "1.1.1.1.1.1.1.1.1.............1",
            "1.1.131.1.1.1.1.1.111111111.111",
            "1.1.1.1.1.1.1.1.1.1...........1",
            "1.1.1...1.1.1...1.1.111.1.111.1",
            "1.1.1.11111111111.1.1.......1.1",
            "1.1.1.1.1.1.1.1.1.1.1.11.11.1.1",
            "1.1.1.1.1.1.1.1.1...1.1...1.1.1",
            "1...1.............1.1.1...1...1",
            "1.111111111111111.1.111111111.1",
            "1................31....3......1",
            "1111111111111111111111111111111",
        ]
    ]
};
